<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Live Class Integration Tester</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: "Segoe UI", AppleSDGothicNeo, "ë§‘ì€ ê³ ë”•", sans-serif;
      margin: 0;
      padding: 40px 20px 80px;
      background: linear-gradient(135deg, #eef2ff 0%, #f8fafc 100%);
      color: #1e293b;
    }
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      color: #0f172a;
    }
    p.description {
      max-width: 720px;
      line-height: 1.6;
      color: #475569;
      margin-bottom: 30px;
    }
    .card {
      background: white;
      border-radius: 18px;
      padding: 28px;
      max-width: 960px;
      margin: 0 auto 28px auto;
      box-shadow: 0 14px 40px rgba(79, 70, 229, 0.1);
      border: 1px solid rgba(148, 163, 184, 0.18);
    }
    .card h2 {
      margin-top: 0;
      font-size: 20px;
      color: #1d4ed8;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .card h2 span.tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(79, 70, 229, 0.12);
      color: #4f46e5;
      padding: 4px 12px;
      border-radius: 9999px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.4px;
    }
    .card button {
      padding: 12px 20px;
      border-radius: 12px;
      border: none;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, #4A6CF7 0%, #7C3AED 100%);
      color: white;
      box-shadow: 0 10px 25px rgba(79, 70, 229, 0.25);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      margin-top: 10px;
    }
    .card button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(79, 70, 229, 0.35);
    }
    .card button:active {
      transform: translateY(0);
    }
    .card button.secondary {
      background: linear-gradient(135deg, #14b8a6 0%, #0ea5e9 100%);
      box-shadow: 0 10px 25px rgba(13, 148, 136, 0.25);
    }
    .card pre {
      background: #0f172a;
      color: #e2e8f0;
      padding: 16px;
      border-radius: 12px;
      max-height: 320px;
      overflow: auto;
      margin-top: 18px;
      font-size: 13px;
      line-height: 1.5;
    }
    .card pre em {
      color: #38bdf8;
    }
    .card ul {
      margin: 12px 0 0 20px;
      color: #475569;
      line-height: 1.6;
    }
    .notice {
      background: rgba(14, 116, 144, 0.1);
      color: #0f172a;
      border-left: 4px solid #0f766e;
      border-radius: 12px;
      padding: 14px 18px;
      margin: 16px 0 0 0;
      font-size: 14px;
      line-height: 1.6;
    }
    footer {
      text-align: center;
      margin-top: 60px;
      color: #94a3b8;
      font-size: 13px;
    }
    .status-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 9999px;
      background: rgba(79, 70, 229, 0.12);
      color: #4338ca;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.5px;
      margin-right: 8px;
    }
    .status-pill.success {
      background: rgba(16, 185, 129, 0.15);
      color: #047857;
    }
    .status-pill.error {
      background: rgba(239, 68, 68, 0.16);
      color: #b91c1c;
    }
  </style>
</head>
<body>
  <h1>Live Class / SSO Test Console</h1>
  <p class="description">
    ì´ í˜ì´ì§€ëŠ” <strong>ì„¸ì…˜ ìœ ì§€ ìƒíƒœì—ì„œ</strong> ì†ì‰½ê²Œ SSO í† í° ìƒì„± ë° ì‹¤ì‹œê°„ ê°•ì˜ ë°ì´í„° ì—°ë™ì„ í™•ì¸í•˜ê¸° ìœ„í•œ
    ê°œë°œìš© ë„êµ¬ì…ë‹ˆë‹¤. ë°˜ë“œì‹œ QA / ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì‚¬ìš©í•˜ê³ , í…ŒìŠ¤íŠ¸ê°€ ëë‚˜ë©´ í˜ì´ì§€ë¥¼ ì‚­ì œí•˜ê±°ë‚˜ ì ‘ê·¼ì„ ì œí•œí•˜ì„¸ìš”.
  </p>

  <div class="card">
    <h2>
      <span class="tag">STEP 1</span> SSO í† í° ìƒì„±
    </h2>
    <p>
      í˜„ì¬ ë¡œê·¸ì¸í•œ ì„¸ì…˜ ì •ë³´ë¡œ <code>/public/member/sso_token_generator.php</code> ì— ìš”ì²­í•˜ì—¬ JWTë¥¼ ë°œê¸‰í•©ë‹ˆë‹¤.
      ì„±ê³µ ì‹œ í† í°/í˜ì´ë¡œë“œê°€ í™”ë©´ì— í‘œì‹œë˜ê³ , <em>ë„ë©”ì¸ ì „ì²´ ê³µìœ ë¥¼ ìœ„í•œ ì¿ í‚¤</em>ê°€ ìë™ ì €ì¥ë©ë‹ˆë‹¤.
    </p>
    <button id="btnGenerateToken">
      <span>ğŸ” í† í° ìƒì„± ìš”ì²­</span>
    </button>
    <div id="tokenStatus" class="notice" style="display:none;"></div>
    <pre id="tokenOutput" style="display:none;"></pre>
  </div>

  <div class="card">
    <h2>
      <span class="tag">STEP 2</span> ì‹¤ì‹œê°„ ê°•ì˜ ëª©ë¡ ì¡°íšŒ
    </h2>
    <p>
      ê´€ë¦¬ì ê³„ì • ë˜ëŠ” ì²¨ì‚­ê°•ì‚¬ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•œ ìƒíƒœë¼ë©´
      <code>/hrd_manager/live_class_search_result.php</code> ë¥¼ í˜¸ì¶œí•˜ì—¬
      MongoDBì—ì„œ ê°•ì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. (POST, ê¸°ë³¸ í•„í„° ì—†ìŒ)
    </p>
    <button id="btnLoadMeetings" class="secondary">
      <span>ğŸ¥ ê°•ì˜ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°</span>
    </button>
    <div class="notice">
      â€¢ ì²¨ì‚­ê°•ì‚¬(Dept=C) ê³„ì •ì€ ë³¸ì¸ ê°•ì˜ë§Œ í‘œì‹œë©ë‹ˆë‹¤.<br>
      â€¢ ê´€ë¦¬ì ê³„ì •ì€ ì „ì²´ ê°•ì˜ê°€ í‘œì‹œë©ë‹ˆë‹¤.<br>
      â€¢ ê²°ê³¼ëŠ” HTML í…Œì´ë¸” í˜•íƒœë¡œ ë°˜í™˜ë˜ë¯€ë¡œ raw HTML ê·¸ëŒ€ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>
    <pre id="meetingsOutput" style="display:none;"></pre>
  </div>

  <div class="card">
    <h2>
      <span class="tag">STEP 3</span> ì ‘ì† íšŒì› ëª©ë¡ ì¡°íšŒ (ê´€ë¦¬ì ì „ìš©)
    </h2>
    <p>
      ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•œ ìƒíƒœì—ì„œë§Œ <code>/hrd_manager/live_members_search_result.php</code> í˜¸ì¶œì´ í—ˆìš©ë©ë‹ˆë‹¤.
      ì²¨ì‚­ê°•ì‚¬ ê³„ì •ì—ì„œëŠ” 403 ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤.
    </p>
    <button id="btnLoadMembers" class="secondary">
      <span>ğŸ‘¥ ì ‘ì† íšŒì› ë¶ˆëŸ¬ì˜¤ê¸°</span>
    </button>
    <div class="notice">
      â€¢ ê²°ê³¼ëŠ” HTML í…Œì´ë¸”ë¡œ ì œê³µë©ë‹ˆë‹¤.<br>
      â€¢ ìµœê·¼ ì ‘ì† ì—¬ë¶€(ì ‘ì†ì¤‘/ì˜¤í”„ë¼ì¸)ê°€ í‘œì‹œë©ë‹ˆë‹¤.<br>
      â€¢ ê¶Œí•œì´ ì—†ìœ¼ë©´ ê±°ë¶€ ë©”ì‹œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>
    <pre id="membersOutput" style="display:none;"></pre>
  </div>

  <footer>
    âš ï¸ ê°œë°œ ì „ìš© í˜ì´ì§€ì…ë‹ˆë‹¤. ì‹¤ì„œë¹„ìŠ¤ì— ë‘ì§€ ë§ˆì„¸ìš”.
  </footer>

  <script>
    async function fetchJSON(url, options = {}) {
      const response = await fetch(url, {
        credentials: 'include',
        headers: { 'Accept': 'application/json' },
        ...options
      });
      const text = await response.text();
      try {
        return { ok: response.ok, data: JSON.parse(text), raw: text };
      } catch (err) {
        return { ok: response.ok, data: null, raw: text };
      }
    }

    function setStatus(target, message, type = 'info') {
      const el = document.getElementById(target);
      if (!el) return;
      el.style.display = 'block';
      el.innerHTML = message;
      if (type === 'success') {
        el.style.background = 'rgba(16, 185, 129, 0.12)';
        el.style.borderLeft = '4px solid #0f766e';
      } else if (type === 'error') {
        el.style.background = 'rgba(239, 68, 68, 0.12)';
        el.style.borderLeft = '4px solid #dc2626';
      } else {
        el.style.background = 'rgba(14, 116, 144, 0.1)';
        el.style.borderLeft = '4px solid #0f766e';
      }
    }

    document.getElementById('btnGenerateToken').addEventListener('click', async () => {
      setStatus('tokenStatus', 'ìš”ì²­ ì¤‘ì…ë‹ˆë‹¤...', 'info');
      const result = await fetchJSON('/public/member/sso_token_generator.php');
      const outputEl = document.getElementById('tokenOutput');
      if (result.ok && result.data && result.data.success) {
        setStatus('tokenStatus', 'âœ… ì„±ê³µì ìœ¼ë¡œ í† í°ì„ ë°œê¸‰í–ˆìŠµë‹ˆë‹¤. (ì¿ í‚¤/LocalStorage ìë™ ì €ì¥)', 'success');
        outputEl.style.display = 'block';
        outputEl.textContent = JSON.stringify(result.data, null, 2);
      } else {
        setStatus('tokenStatus', 'âŒ í† í° ë°œê¸‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ ìƒíƒœ ë˜ëŠ” ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”.', 'error');
        outputEl.style.display = 'block';
        outputEl.textContent = result.raw || '(ì‘ë‹µ ì—†ìŒ)';
      }
    });

    document.getElementById('btnLoadMeetings').addEventListener('click', async () => {
      const outputEl = document.getElementById('meetingsOutput');
      outputEl.style.display = 'block';
      outputEl.textContent = 'ìš”ì²­ ì¤‘ì…ë‹ˆë‹¤...';
      try {
        const response = await fetch('/hrd_manager/live_class_search_result.php', {
          method: 'POST',
          credentials: 'include'
        });
        const text = await response.text();
        outputEl.textContent = text;
      } catch (error) {
        outputEl.textContent = 'ì˜¤ë¥˜ ë°œìƒ: ' + error.message;
      }
    });

    document.getElementById('btnLoadMembers').addEventListener('click', async () => {
      const outputEl = document.getElementById('membersOutput');
      outputEl.style.display = 'block';
      outputEl.textContent = 'ìš”ì²­ ì¤‘ì…ë‹ˆë‹¤...';
      try {
        const response = await fetch('/hrd_manager/live_members_search_result.php', {
          method: 'POST',
          credentials: 'include'
        });
        const text = await response.text();
        outputEl.textContent = text;
      } catch (error) {
        outputEl.textContent = 'ì˜¤ë¥˜ ë°œìƒ: ' + error.message;
      }
    });
  </script>
</body>
</html>

